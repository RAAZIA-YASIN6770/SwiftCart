:root {
    --glitch-intensity: 0;
    --redshift-primary: #ff003c;
    --redshift-cyan: #00f3ff;
    --redshift-magenta: #ff00ff;
}

.glitch-container {
    position: relative;
    overflow: hidden;
}

.glitch-image {
    display: block;
    width: 100%;
    height: auto;
    transition: filter 0.2s ease;
    will-change: filter, transform;
}

/* Trigger glitch when intensity > 0 */
.glitch-active .glitch-image {
    filter: url(#redshift-glitch);
    animation: glitch-flicker 0.2s infinite;
}

/* Scanlines effect */
.glitch-active::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(0deg,
            rgba(0, 0, 0, 0.2),
            rgba(0, 0, 0, 0.2) 1px,
            transparent 1px,
            transparent 2px);
    pointer-events: none;
    opacity: var(--glitch-intensity);
    z-index: 2;
}

@keyframes glitch-flicker {
    0% {
        opacity: 1;
        transform: translate(0);
    }

    10% {
        opacity: 0.8;
        transform: translate(calc(var(--glitch-intensity) * -2px), calc(var(--glitch-intensity) * 1px));
    }

    20% {
        opacity: 1;
        transform: translate(calc(var(--glitch-intensity) * 2px), 0);
    }

    30% {
        opacity: 0.9;
        transform: translate(0, calc(var(--glitch-intensity) * -1px));
    }

    40% {
        opacity: 1;
        transform: translate(calc(var(--glitch-intensity) * -2px), 0);
    }

    100% {
        opacity: 1;
        transform: translate(0);
    }
}

@keyframes glitch-stutter {

    0%,
    100% {
        clip-path: inset(0 0 0 0);
        transform: translate(0);
    }

    20% {
        clip-path: inset(10% 0 40% 0);
        transform: translate(-5px, 2px);
    }

    40% {
        clip-path: inset(50% 0 10% 0);
        transform: translate(5px, -2px);
    }

    60% {
        clip-path: inset(30% 0 30% 0);
        transform: translate(-2px, 5px);
    }

    80% {
        clip-path: inset(15% 0 15% 0);
        transform: translate(2px, -5px);
    }
}

@keyframes glitch-desync {
    0% {
        transform: translate(0);
    }

    20% {
        transform: translate(3px, -2px);
    }

    40% {
        transform: translate(-3px, 2px);
    }

    60% {
        transform: translate(2px, 3px);
    }

    80% {
        transform: translate(-2px, -3px);
    }

    100% {
        transform: translate(0);
    }
}

.glitch-stutter .glitch-image {
    animation: glitch-stutter 0.3s steps(4) infinite;
}

.glitch-desync {
    animation: glitch-desync 0.05s infinite;
}

/* VHS Rewind Effect [STORY 5.2] */
.vhs-rewind {
    filter: url(#redshift-glitch);
    position: relative;
    animation: vhs-jitter 0.15s infinite;
}

.vhs-rewind::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(0deg,
            rgba(255, 255, 255, 0.1),
            rgba(255, 255, 255, 0.1) 1px,
            transparent 1px,
            transparent 2px);
    pointer-events: none;
    z-index: 3;
    animation: vhs-scanlines 0.2s infinite;
}

.vhs-rewind::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: rgba(255, 255, 255, 0.4);
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    z-index: 4;
    animation: vhs-tracking 1s linear infinite;
}

@keyframes vhs-jitter {
    0% {
        transform: translateY(0) skew(0deg);
        filter: hue-rotate(0deg);
    }

    25% {
        transform: translateY(-1px) skew(1deg);
        filter: hue-rotate(90deg);
    }

    50% {
        transform: translateY(2px) skew(-1deg);
        filter: hue-rotate(180deg);
    }

    75% {
        transform: translateY(-2px) skew(0deg);
        filter: hue-rotate(270deg);
    }

    100% {
        transform: translateY(0) skew(0deg);
        filter: hue-rotate(360deg);
    }
}

@keyframes vhs-scanlines {
    0% {
        opacity: 0.3;
    }

    50% {
        opacity: 0.7;
    }

    100% {
        opacity: 0.3;
    }
}

@keyframes vhs-tracking {
    0% {
        top: -10%;
    }

    100% {
        top: 110%;
    }
}

/* Masking: Ensure text/buttons stay clean */
.orb-content {
    position: relative;
    z-index: 1;
}

.orb-ui-overlay {
    position: absolute;
    bottom: 10%;
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;
    pointer-events: auto;
    /* Ensure readability */
    text-shadow: 0 0 8px rgba(0, 0, 0, 1), 0 0 3px rgba(0, 0, 0, 1);
    color: white;
    width: 100%;
    text-align: center;
}